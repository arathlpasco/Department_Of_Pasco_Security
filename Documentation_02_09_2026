# Technical Documentation
**Project:** Department of Pasco Security (DPS) Home Lab  
**Author:** Arath Luis Pasco  
**Date:** February 9, 2026  

---

## 1. Workstation & System Isolation
To maintain system hygiene and protect academic data, a dedicated macOS User Profile was established for this project. This ensures virtualization experiments remain isolated from primary system resources and prevents accidental interference with personal school files.

### **Storage Strategy**
All assets are persistent on an external **2TB SSD**, formatted for optimal Apple Silicon throughput and encrypted for data security.
![Disk Utility formatting the LaCie drive as APFS Encrypted](Arath_Driver_Format.jpg)

---

## 2. Image Preparation & Virtual Disk Engineering
The OPNsense raw image was converted to a VMware-compatible format (`.vmdk`) using the `qemu-img` utility.

### **Hardware Compatibility Fix**
Initial boot failed due to a driver mismatch with the default NVMe bus. I reconfigured the Virtual Disk Bus to **SATA** to ensure the FreeBSD kernel could initialize the storage successfully.

---

## 3. Network Architecture: The "Two-Door" Model
The lab utilizes a dual-homed configuration to isolate internal traffic from the internet.

| Interface | VMware Setting | Purpose |
| :--- | :--- | :--- |
| **WAN (em0)** | Bridged (Autodetect) | Internet uplink via host Wi-Fi. |
| **LAN (em1)** | Custom (`DPS_INTERNAL_NETWORK\`) | Private gateway for internal assets. |

[Image of a network diagram showing OPNsense as a gateway connecting a Windows 11 client to the internet]

### **Virtual Hardware Configuration**
The following screenshots confirm the precise mapping of the virtual network adapters and subnets within VMware Fusion.

**Adapter 1 (WAN - em0)** ![VMware settings showing Network Adapter 1 set to Bridged Autodetect](FreeBSD_14_Network_Adapter_Config.jpg)

**Adapter 2 (LAN - em1)** ![VMware settings showing Network Adapter 2 set to Custom DPS_INTERNAL_NETWORK](FreeBSD_14_Network_Adapter_2_Config.jpg)

**Hypervisor Level Network (Subnet Definition)** ![VMware Network Preferences showing DPS_INTERNAL_NETWORK defined as 10.0.50.0](DPS_Internal_Network_Config.jpg)

---

## 4. Console Configuration & Implementation
The OPNsense kernel was initialized through the terminal console. I successfully transitioned the LAN from the factory default (`192.168.1.1`) to the custom lab subnet (`10.0.50.1`).

**Interface Overview (Post-Provisioning)** ![OPNsense console showing LAN (em0) successfully set to 10.0.50.1/24](OPNsense_LAN_WAN.jpg)

### **Key Console Commands & Security**
* **DHCP Scope**: Established a stateful range of `10.0.50.100` to `10.0.50.200`.
* **Encryption**: Generated a self-signed SHA256 SSL certificate to secure management traffic via HTTPS.

---

## 5. Client Integration (Windows 11)
The internal Windows 11 client was bridged to the `DPS_INTERNAL_NETWORK\`. Upon rebooting, the client successfully "handshaked" with the OPNsense gateway via DHCP.

**Client Network Verification (ipconfig)** ![Windows 11 terminal showing initial assigned IP](Screenshot_2026-02-09_at_1.27.45_AM.png)  
*(Note: Final validation confirmed the transition to the 10.0.50.100+
